function planResult(response){jQuery("body").removeClass("isv-loading");var response_obj=JSON.parse(response);console.log(response_obj),1===response_obj.result?document.location=response_obj.basketurl:alert(response_obj.description)}jQuery(document).ready(function($){function isv_get_feed(feedcode,filters,id,content,from,until){var start=performance.now();$("#"+id).html(window.isv_params.loader),$.ajax({url:window.isv_params.ajax_url,method:"POST",data:{action:"isv_get_feed",feedcode:feedcode,filters:filters,id:id,content:content,from:from,until:until,start:start,debug:!0},dataType:"json",success:isv_get_feed_done})}function isv_get_feed_done(response){console.log(response),response.debug===!0?$("#"+response.id).html("<pre>"+response.html+"</pre>"):$("#"+response.id).html(response.html);var end=performance.now();console.log('AJAX call "isv_get_feed" took '+Math.floor(end-response.start)+" miliseconds."),isv_bind_ctas()}function isv_bind_ctas(){$(".isv-book-button").unbind("click").on("click",isv_book_btn_clicked),$(".isv-button-fetch-filtered").unbind("click").on("click",isv_filter_btn_clicked),$(".isv-datepicker").datepicker({minDate:new Date,dateFormat:"dd-mm-yy"})}function isv_filter_btn_clicked(e){e.preventDefault();var $feed=$(this),feedcode=$feed.data("feedcode"),filters=$feed.data("filters"),id=$feed.data("id"),content=$feed.data("content"),from=$("#isv-from-"+feedcode).val(),until=$("#isv-until-"+feedcode).val();return isv_get_feed(feedcode,filters,id,content,from,until),!1}function isv_book_btn_clicked(e){e.preventDefault(),$button=$(this),$button.addClass("isv-loading"),$("body").addClass("isv-loading");var ajax_url=window.isv_params.bookingspage_endpoint_uri+"?planitem&key="+$button.data("key")+"&feedcode="+$button.data("feedcode")+"&url="+document.location.href;return $.ajax({url:ajax_url,method:"GET",dataType:"jsonp",jsonpCallback:"planResult"}),!1}var $feeds=$(".isv-feed");$feeds.length>0&&$feeds.each(function(){var $feed=$(this),feedcode=$feed.data("feedcode"),filters=$feed.data("filters"),content=$feed.data("content"),id=$feed.attr("id");isv_get_feed(feedcode,filters,id,content,"","")})});